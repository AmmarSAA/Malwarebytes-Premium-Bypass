:: ==================================================
::  Malwarebytes-Premium-Reset v3.0
:: ==================================================
::  Dev  - Scut1ny
::  Help - 
::  Link - https://github.com/Scrut1ny/Malwarebytes-Premium-Reset
:: ==================================================


@echo off
title Malwarebytes-Premium-Reset ^| v3.0

fltmc >nul 2>&1 || (
    echo( && echo   [33m# Administrator privileges are required. && echo([0m
    PowerShell Start -Verb RunAs '%0' 2> nul || (
        echo   [33m# Right-click on the script and select "Run as administrator".[0m
        >nul pause && exit 1
    )
    exit 0
)

echo( && echo   [ [34mMalwarebytes: Premium Automated 14 Day Trial Reset[0m ]
echo( && echo   # Checking for existing scheduled task

:: Check if scheduled task already exists
schtasks /query /tn "Malwarebytes-Premium-Reset" >nul 2>&1
if not errorlevel 1 (
    echo( && echo   [ [32mInfo[0m ] Scheduled task already exists.
) else (
    echo( && echo   # Creating [33mscheduled task[0m
    :: Create scheduled task to run every 14 days
    schtasks /create /tn "Malwarebytes-Premium-Reset" /tr "%~dp0%~nx0" /sc weekly /mo 2 /ru SYSTEM /f >nul 2>&1
)

echo( && echo   # Spoofing cryptography [33mMachineGuid[0m

:: Generate new GUID and set it as MachineGuid
for /f %%a in ('powershell -c "[guid]::NewGuid().ToString()"') do (
    reg add "HKLM\SOFTWARE\Microsoft\Cryptography" /v "MachineGuid" /t REG_SZ /d "%%a" /f >nul
)

echo( && echo   # [32mDone![0m && timeout /t 3 >nul
